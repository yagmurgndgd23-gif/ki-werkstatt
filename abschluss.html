<!doctype html>
<html lang="de">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>KI-Wand der Erkenntnisse</title>

    <style>
        body{
            margin:0;
            font-family: Arial, sans-serif;
            background: radial-gradient(circle at top, #e8dcff 0%, #c7a6ff 50%, #7a38b6 100%);
            min-height:100vh;
            display:flex;
            justify-content:center;
            align-items:center;
            padding:30px;
            color:#2a153d;
        }

        .wrap{
            width:min(1100px, 95vw);
            display:grid;
            gap:16px;
        }

        .card{
            background: rgba(255,255,255,0.90);
            border-radius: 18px;
            padding: 20px;
            box-shadow: 0 12px 35px rgba(52,10,88,0.35);
            border:1px solid rgba(120,60,190,0.25);
        }

        h2{ margin:0 0 10px 0; font-size:28px; }
        p{ margin:0; line-height:1.6; }

        .bubble-row{
            display:flex;
            gap:10px;
            flex-wrap:wrap;
            margin-top:14px;
            align-items:center;
        }

        .bubble{
            cursor:pointer;
            border:none;
            border-radius:999px;
            padding:10px 14px;
            font-weight:800;
            font-size:13px;
            color:white;
            background: linear-gradient(135deg, #a35cff, #6a22cc);
            box-shadow: 0 10px 22px rgba(91,25,184,0.22);
            transition: filter 0.12s ease, transform 0.12s ease;
        }
        .bubble:hover{ filter:brightness(1.05); transform: translateY(-1px); }
        .bubble.active{ outline: 3px solid rgba(255,255,255,0.65); box-shadow: inset 0 0 0 2px #4a1c7a; }

        .input-row{
            display:grid;
            grid-template-columns: 1fr auto auto;
            gap:10px;
            margin-top:12px;
            align-items:center;
        }

        textarea{
            width:100%;
            min-height:52px;
            resize:vertical;
            border-radius:14px;
            border:1px solid rgba(120,60,190,0.25);
            background: rgba(255,255,255,0.85);
            padding:12px;
            font-family: Arial, sans-serif;
            font-size:14px;
            line-height:1.4;
            box-shadow: 0 10px 22px rgba(52,10,88,0.10);
            outline:none;
        }
        textarea:focus{
            border-color: rgba(163, 92, 255, 0.55);
            box-shadow: 0 10px 22px rgba(91,25,184,0.16);
        }

        button.action{
            border:none;
            cursor:pointer;
            border-radius:999px;
            padding:10px 14px;
            font-weight:bold;
            background: linear-gradient(135deg, #a35cff, #5b19b8);
            color:white;
            box-shadow: 0 10px 22px rgba(91,25,184,0.25);
            transition: filter 0.12s ease, transform 0.12s ease;
            white-space:nowrap;
        }
        button.action:hover{ filter:brightness(1.05); transform: translateY(-1px); }

        button.secondary{
            background: rgba(255,255,255,0.90);
            color:#4a1c7a;
            border:1px solid rgba(120,60,190,0.25);
            box-shadow: 0 10px 22px rgba(91,25,184,0.12);
        }

        .wall{
            margin-top:14px;
            height:540px;
            border-radius:16px;
            border:2px dashed rgba(110,40,190,0.30);
            background: rgba(255,255,255,0.70);
            position:relative;
            overflow:hidden;
            padding:12px;
            box-sizing:border-box;
            cursor: crosshair; /* Affordanz f√ºr "Platzieren" */
        }

        .postit{
            position:absolute;
            width: 240px;
            background: rgba(255, 250, 170, 0.92);
            border:1px solid rgba(160, 130, 20, 0.35);
            border-radius:12px;
            padding:10px;
            box-shadow: 0 10px 22px rgba(52,10,88,0.18);
            transform: rotate(var(--rot));
            cursor:pointer;
            user-select:none;
            transition: transform 0.1s;
        }
        .postit:hover{ transform: scale(1.05) rotate(0deg); z-index:100; }

        .postit b{
            display:block;
            margin-bottom:6px;
        }

        .hint{
            margin-top:10px;
            font-size:13px;
            opacity:0.85;
        }

        .links{
            margin-top:12px;
            display:flex;
            gap:14px;
            flex-wrap:wrap;
            align-items:center;
        }

        a.link{
            text-decoration:none;
            font-weight:bold;
            color:#4a1c7a;
        }

        @media (max-width: 900px){
            .input-row{ grid-template-columns: 1fr; }
            .wall{ height:520px; }
        }
    </style>
</head>

<body>
<div class="wrap">
    <div class="card">
        <h2>‚≠ê KI-Wand der Erkenntnisse</h2>
        <p>Schreibe deinen Text. Wir haben "Idee" f√ºr dich vor-ausgew√§hlt, damit du sofort loslegen kannst.</p>

        <div class="bubble-row">
            <button class="bubble" data-title="Gelernt:" data-placeholder="Eine Sache, die ich gelernt habe‚Ä¶">üß† Gelernt</button>
            <button class="bubble" data-title="Regel:" data-placeholder="Eine Regel f√ºr gesunde KI-Nutzung‚Ä¶">üìè Regel</button>
            <button class="bubble" data-title="Idee:" data-placeholder="Eine kreative Idee, die mir die KI-Werkstatt gegeben hat‚Ä¶">‚ú® Idee</button>
        </div>

        <div class="input-row">
            <textarea id="textInput" placeholder="Tippe hier deine Idee..."></textarea>
            <button class="action" id="placeMode" type="button">üìå Platzieren</button>
            <button class="action secondary" id="reset" type="button">üóëÔ∏è Wand leeren</button>
        </div>

        <div class="wall" id="wall" aria-label="Erkenntnis-Wand" title="Klicke hier rein, um die Notiz zu kleben"></div>

        <div class="hint">
            Hinweis: Klick auf eine Notiz = l√∂schen. Es wird nichts gespeichert (nur Demo).
        </div>

        <div class="links">
            <a class="link" href="yara_aufgabe.html">‚Üê Zur√ºck zu Yara</a>
            <button class="action secondary" type="button" onclick="window.location.href='index.html'">
                üè† Zur√ºck zum Start
            </button>
        </div>

    </div>

    <script>
        const bubbles = document.querySelectorAll(".bubble");
        const textInput = document.getElementById("textInput");
        const wall = document.getElementById("wall");
        const resetBtn = document.getElementById("reset");
        const placeBtn = document.getElementById("placeMode");

        let active = null;
        let placeArmed = false;

        // Bubble ausw√§hlen
        bubbles.forEach(b => {
            b.addEventListener("click", () => {
                bubbles.forEach(x => x.classList.remove("active"));
                b.classList.add("active");

                active = {
                    title: b.dataset.title,
                    placeholder: b.dataset.placeholder
                };

                textInput.placeholder = active.placeholder;
                textInput.focus();
            });
        });

        // --- VERBESSERUNG: THERBLIGS (Vorselektion) ---
        // Wir w√§hlen automatisch "Idee" aus, damit der Nutzer sofort tippen kann.
        // Spart den kognitiven Schritt "Suchen & Ausw√§hlen" vor dem Tippen.
        const defaultBubble = document.querySelector('.bubble[data-title="Idee:"]');
        if(defaultBubble) defaultBubble.click();
        // ----------------------------------------------

        // Platziermodus aktivieren
        placeBtn.addEventListener("click", () => {
            if (!active) {
                alert("Bitte w√§hle eine Kategorie (Bubble).");
                return;
            }
            if (!textInput.value.trim()) {
                alert("Bitte einen Text eingeben.");
                textInput.focus();
                return;
            }
            placeArmed = true;
            placeBtn.textContent = "‚úÖ Jetzt in die Wand klicken‚Ä¶";
            wall.style.background = "rgba(255,255,255,0.9)"; // Visuelles Feedback
        });

        // In die Wand klicken -> Post-it setzen
        wall.addEventListener("click", (e) => {
            if (!placeArmed || !active) return;

            const txt = textInput.value.trim();
            if (!txt) return;

            const rect = wall.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            const note = document.createElement("div");
            note.className = "postit";

            const rot = (Math.random() * 10 - 5).toFixed(1) + "deg";
            note.style.setProperty("--rot", rot);

            // Position clamp
            const w = 240;
            const h = 130;
            const left = Math.max(10, Math.min(x - w/2, rect.width - w - 10));
            const top  = Math.max(10, Math.min(y - 30, rect.height - h - 10));

            note.style.left = left + "px";
            note.style.top  = top + "px";

            note.innerHTML = "<b>" + active.title + "</b>" + escapeHtml(txt);

            note.addEventListener("click", (ev) => {
                ev.stopPropagation();
                note.remove();
            });

            wall.appendChild(note);

            // Reset Place Mode
            placeArmed = false;
            placeBtn.textContent = "üìå Platzieren";
            wall.style.background = "rgba(255,255,255,0.70)";
            textInput.value = "";
            textInput.focus();
        });

        // Reset
        resetBtn.addEventListener("click", () => {
            wall.innerHTML = "";
            textInput.value = "";
            placeArmed = false;
            placeBtn.textContent = "üìå Platzieren";
            wall.style.background = "rgba(255,255,255,0.70)";
            // Reset Auswahl auf Default
            if(defaultBubble) defaultBubble.click();
        });

        function escapeHtml(str){
            return str
                .replaceAll("&", "&amp;")
                .replaceAll("<", "&lt;")
                .replaceAll(">", "&gt;")
                .replaceAll('"', "&quot;")
                .replaceAll("'", "&#039;")
                .replaceAll("\n", "<br>");
        }
    </script>
</body>
</html>