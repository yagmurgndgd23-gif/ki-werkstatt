<!doctype html>
<html lang="de">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Station 3 ‚Äì Yara (Aufgabe)</title>

    <style>
        html, body{
            margin:0;
            padding:0;
            font-family: Arial, sans-serif;
            background: radial-gradient(circle at top, #e8dcff 0%, #c7a6ff 50%, #7a38b6 100%);
            color:#2a153d;
        }

        body{
            min-height:100vh;
            display:flex;
            justify-content:center;
            align-items:flex-start;
            padding:30px;
            box-sizing:border-box;
        }

        .wrap{
            width:min(1100px, 95vw);
            display:grid;
            gap:16px;
        }

        .card{
            background: rgba(255,255,255,0.90);
            border-radius: 18px;
            padding: 20px;
            box-shadow: 0 12px 35px rgba(52,10,88,0.35);
            border:1px solid rgba(120,60,190,0.25);
        }

        h2{ margin:0 0 10px 0; font-size:28px; }
        p{ margin:0; line-height:1.6; }

        .toolbar{
            display:flex;
            gap:10px;
            flex-wrap:wrap;
            margin-top:14px;
            align-items:center;
        }

        button{
            border:none;
            cursor:pointer;
            border-radius:999px;
            padding:10px 14px;
            font-weight:bold;
            background: linear-gradient(135deg, #a35cff, #6a22cc);
            color:white;
            box-shadow: 0 10px 22px rgba(91,25,184,0.25);
            transition: filter 0.12s ease, transform 0.12s ease, opacity 0.12s ease;
        }
        button:hover{
            filter:brightness(1.05);
            transform: translateY(-1px);
        }
        button:disabled{
            opacity:0.55;
            cursor:not-allowed;
            transform:none;
        }

        /* Textbereich */
        .paper{
            margin-top:14px;
            border-radius:16px;
            border:2px dashed rgba(110,40,190,0.30);
            background: rgba(255,255,255,0.70);
            padding:16px;
            line-height:2.0;
            font-size:16px;
            max-height: 460px;
            overflow-y: auto;
        }

        /* --- SIGNIFIERS & AFFORDANZEN --- */
        .token{
            cursor:pointer;
            padding: 1px 3px;
            margin: 0 1px;
            border-radius: 4px;
            background: transparent;
            transition: all 0.15s ease;
            display:inline-block;
            border-bottom: 2px solid rgba(163, 92, 255, 0.25);
            user-select:none;
        }

        .token:hover{
            background: rgba(163, 92, 255, 0.15);
            border-bottom-color: #a35cff;
            transform: translateY(-1px);
        }

        .token.active{
            background: rgba(255, 230, 120, 0.95);
            border-bottom-color: #eebb00;
            color: black;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .para{ margin: 16px 0; }

        .hint{
            margin-top:10px;
            font-size:13px;
            opacity:0.85;
        }

        .links{
            margin-top:12px;
            display:flex;
            gap:14px;
            flex-wrap:wrap;
            align-items:center;
        }

        a.link{
            text-decoration:none;
            font-weight:bold;
            color:#4a1c7a;
        }

        a.primary{
            padding:10px 14px;
            border-radius:999px;
            color:white;
            background: linear-gradient(135deg, #a35cff, #5b19b8);
            box-shadow: 0 10px 22px rgba(91,25,184,0.25);
        }
        a.primary:hover{ filter:brightness(1.05); }

        .status{
            margin-top:10px;
            font-size:13px;
            opacity:0.9;
            display:flex;
            gap:10px;
            align-items:center;
            flex-wrap:wrap;
        }
        .pill{
            background: rgba(163,92,255,0.12);
            border:1px solid rgba(163,92,255,0.22);
            padding:6px 10px;
            border-radius:999px;
        }
    </style>
</head>

<body>
<div class="wrap">
    <div class="card">
        <h2>üìö Yaras Aufgabe ‚Äì Hinweise markieren</h2>
        <p>
            Klicke auf W√∂rter oder Zeichen, die nach KI klingen (z.B. ‚ÄûZusammenfassend‚Äú, ‚Äûsehr‚Äú).<br>
            <b>Tipp:</b> Fahre mit der Maus √ºber den Text: Hover zeigt dir klickbare Teile (Signifier).
        </p>

        <div class="toolbar">
            <button id="undo" type="button" disabled>‚Ü©Ô∏è R√ºckg√§ngig</button>
            <button id="reset" type="button">üßπ Alles zur√ºcksetzen</button>
        </div>

        <div class="status">
            <span class="pill" id="countPill">Markiert: 0</span>
            <span class="pill" id="undoPill">Undo verf√ºgbar: nein</span>
        </div>

        <div class="paper">
            <b>Beispieltext (gemischt):</b><br><br>
            <div id="tokenText">
                K√ºnstliche Intelligenz ist ein sehr wichtiges Thema, das in vielen Bereichen Anwendung findet.
                Es gibt zahlreiche Vorteile, die durch den Einsatz von KI entstehen k√∂nnen. Gleichzeitig sollte man jedoch auch Herausforderungen ber√ºcksichtigen.

                Ich habe gestern gemerkt, dass ich beim Schreiben oft viel zu sp√§t anfange.
                Dann nehme ich Abk√ºrzungen ‚Äî und manchmal w√§re Hilfe ganz gut.
                Dabei ist es wichtig, verantwortungsvoll mit der Technologie umzugehen, denn KI kann sowohl positive als auch negative Effekte haben.

                Zusammenfassend l√§sst sich sagen, dass KI eine bedeutende Rolle spielt und man sie sinnvoll nutzen sollte.
            </div>
        </div>

        <div class="hint">
            Typische Hinweise: sehr allgemeine W√∂rter (‚Äûwichtig‚Äú, ‚Äûzahlreich‚Äú), perfekte Struktur, Floskeln (‚ÄûZusammenfassend‚Ä¶‚Äú), wenig echte Beispiele.
        </div>

        <div class="links">
            <a class="link primary" href="abschluss.html">Weiter ‚Üí Wand der Erkenntnisse</a>
        </div>
    </div>
</div>

<script>
    const resetBtn = document.getElementById("reset");
    const undoBtn  = document.getElementById("undo");
    const tokenText = document.getElementById("tokenText");

    const countPill = document.getElementById("countPill");
    const undoPill = document.getElementById("undoPill");

    // Undo-Stack: speichert inverse Operationen (Gruppen-Theorie / Reversibilit√§t)
    const undoStack = [];

    function tokenize(line) {
        return line.match(/[\p{L}\p{N}]+|[^\s\p{L}\p{N}]/gu) || [];
    }

    function updateUI() {
        const marked = document.querySelectorAll(".token.active").length;
        countPill.textContent = `Markiert: ${marked}`;

        const hasUndo = undoStack.length > 0;
        undoBtn.disabled = !hasUndo;
        undoPill.textContent = `Undo verf√ºgbar: ${hasUndo ? "ja" : "nein"}`;
    }

    function renderTokenizedText() {
        const raw = tokenText.textContent;
        const lines = raw.split("\n");

        const container = document.createElement("div");

        lines.forEach(line => {
            const trimmed = line.trim();
            if (trimmed.length === 0) {
                const spacer = document.createElement("div");
                spacer.className = "para";
                container.appendChild(spacer);
                return;
            }

            const tokens = tokenize(trimmed);
            const p = document.createElement("div");
            p.className = "para";

            tokens.forEach((t, idx) => {
                const span = document.createElement("span");
                span.className = "token";
                span.textContent = t;

                span.addEventListener("click", () => {
                    const wasActive = span.classList.contains("active");
                    span.classList.toggle("active");
                    const isActive = span.classList.contains("active");

                    // Undo: einfach wieder togglen (inverse Operation)
                    undoStack.push(() => {
                        // Setze wieder auf vorherigen Zustand
                        span.classList.toggle("active", wasActive);
                        updateUI();
                    });

                    // Konsistenz: wenn Toggle keinen Zustand ver√§ndert hat (sollte nie), keine Action
                    if (wasActive === isActive) undoStack.pop();

                    updateUI();
                });

                p.appendChild(span);

                const next = tokens[idx + 1];
                const isPunct = (x) => x && /[^\p{L}\p{N}]/u.test(x);
                if (next && !isPunct(next)) {
                    p.appendChild(document.createTextNode(" "));
                }
            });

            container.appendChild(p);
        });

        tokenText.innerHTML = "";
        tokenText.appendChild(container);
    }

    undoBtn.addEventListener("click", () => {
        const action = undoStack.pop();
        if (action) action();
        updateUI();
    });

    resetBtn.addEventListener("click", () => {
        const activeNow = Array.from(document.querySelectorAll(".token.active"));
        if (activeNow.length === 0) return;

        // Reset ist destruktiv ‚Üí aber wir machen ihn reversibel (Undo-Action speichert vorherigen Zustand)
        const snapshot = activeNow.map(el => el);
        undoStack.push(() => {
            snapshot.forEach(el => el.classList.add("active"));
            updateUI();
        });

        document.querySelectorAll(".token.active").forEach(t => t.classList.remove("active"));
        updateUI();
    });

    renderTokenizedText();
    updateUI();
</script>
</body>
</html>
